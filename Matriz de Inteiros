#include<stdio.h>
#include<stdlib.h>

int calculaQtdLinhas(int qtdLinhas){
    FILE *arq;
    arq= fopen("entrada.txt","r");
    
    char ch;
    qtdLinhas=1;
    while((ch=fgetc(arq))!= EOF)
    {
        if(ch == '\n')
        {
            qtdLinhas++;
        }
        
    }
    fclose(arq);
    return qtdLinhas;
}

int calculaQtdElementos(int qtdLinhas, int qtdElementos){
    FILE *arq;
    arq= fopen("entrada.txt","r");
    
    char ch;
    while((ch=fgetc(arq))!= EOF)
    {
        if(ch == ' ')
        {
            qtdElementos++;
        }
        
    }
    qtdElementos += qtdLinhas-1;
    fclose(arq);
    return qtdElementos;
}

int calculaQtdColunas(int qtdLinhas, int qtdElementos, int qtdColunas){
    if(qtdElementos > 0 && qtdLinhas > 0)
    {   
        float calculoColunas;
        calculoColunas = qtdElementos/qtdLinhas;
        if(calculoColunas != (int)calculoColunas)
        {
            //Matriz inválida
            return 0;
        }
        else
        {
            qtdColunas = (int)calculoColunas;    
        }
    }
    return qtdColunas;
}


int validaMatriz(int qtdLinhas, int qtdElementos, int qtdColunas){
    if(qtdElementos > 0 && qtdLinhas > 0)
    {   
        float calculoColunas;
        calculoColunas = qtdElementos/qtdLinhas;
        if(calculoColunas != (int)calculoColunas)
        {
            printf("Matriz Inválida!");
            return 0;
        }
        if(qtdLinhas % 2 != 0)
        {
            printf("O numero de linhas da matriz deve ser par!");
            return 0;
        }
        if(qtdColunas % 2 != 0)
        {
            printf("O numero de colunas da matriz deve ser par!");
            return 0;
        }
    }
    return 1;
}


int main()
{
    int qtdLinhas = calculaQtdLinhas(qtdLinhas);
    int qtdElementos = calculaQtdElementos(qtdLinhas, qtdElementos);
    int qtdColunas = calculaQtdColunas(qtdLinhas, qtdElementos, qtdColunas);
        printf("%d/%d/%d\n\n", qtdLinhas, qtdElementos, qtdColunas);

    int validacao = validaMatriz(qtdLinhas, qtdElementos, qtdColunas);
    if(validacao == 0)
    {
        return 0;
    }
    
    printf("%d/%d/%d\n\n", qtdLinhas, qtdElementos, qtdColunas);
    
    int matriz[qtdLinhas][qtdColunas];
    int i,j;
    int a,b;
    
    FILE *arq;
    
    arq= fopen("entrada.txt","r");
    while(!feof(arq))
    {
        for(i=0;i<qtdLinhas;i++)
        {
            for(j=0;j<4;j++)
            {
                fscanf(arq,"%d",&matriz[i][j]);
            }
        }
    }

    for(a=0;a<qtdLinhas;a++)
    {
        for(b=0;b<4;b++)
        {
            printf("%d|",matriz[a][b]);
        }
        printf("\n");
    }

    fclose(arq);
    return 0;
}
